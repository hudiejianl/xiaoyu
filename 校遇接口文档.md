# 社交平台 API 接口文档 v2.0

## 一、用户认证模块

### ×1.1 QQ授权登录

- **接口地址**: `POST /api/auth/qq/login`

- **接口说明**: QQ第三方登录授权

- **请求头**:
  
  ```
  Content-Type: application/json
  ```

- **请求参数**:
  
  | 参数名   | 类型     | 必填  | 说明            |
  | ----- | ------ | --- | ------------- |
  | code  | string | 是   | QQ授权返回的code   |
  | state | string | 是   | 防CSRF攻击的随机字符串 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "登录成功",
    "data": {
      "access_token": "eyJhbGciOiJIUzI1NiIs...",
      "refresh_token": "eyJhbGciOiJIUzI1NiIs...",
      "expires_in": 7200,
      "user": {
        "id": 1001,
        "nickname": "用户昵称",
        "avatar_url": "https://oss.example.com/avatar/1001.jpg",
        "gender": 1,
        "campus_id": 1,
        "is_real_name": 0,
        "created_at": "2023-01-01T00:00:00Z"
      }
    }
  }
  ```

### ×1.2 手机号登录

- **接口地址**: `POST /api/auth/mobile/login`

- **接口说明**: 手机号验证码登录

- **请求参数**:
  
  | 参数名    | 类型     | 必填  | 说明     |
  | ------ | ------ | --- | ------ |
  | mobile | string | 是   | 11位手机号 |
  | code   | string | 是   | 6位验证码  |

- **响应数据**: 同QQ登录





### 1.2 账号密码登录

* **接口地址**: `POST /api/auth/password/register`

* **接口说明**: 账号密码登录

* **请求参数**:
  
  | 参数名      | 类型     | 必填  | 说明       |
  | -------- | ------ | --- | -------- |
  | account  | string | 是   | 账号 8 位   |
  | password | string | 是   | 密码 -- 限制 |

* **响应数据**:

    {
      "code": 200,
      "message": "注册成功",
      }
    }



### 1.2 账号密码登录

* **接口地址**: `POST /api/auth/password/login`

* **接口说明**: 账号密码登录

* **请求参数**:
  
  | 参数名      | 类型     | 必填  | 说明       |
  | -------- | ------ | --- | -------- |
  | account  | string | 是   | 账号 8 位   |
  | password | string | 是   | 密码 -- 限制 |

* **响应数据**: 

```js
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIs...",
    "expires_in": 7200,
    "user": {
      "id": 1001,
      "nickname": "用户昵称",
      "avatar_url": "https://oss.example.com/avatar/1001.jpg",
      "gender": 1,
      "campus_id": 1,
      "is_real_name": 0,
      "created_at": "2023-01-01T00:00:00Z"
    }
  }
}
```

### 1.3 发送验证码

- **接口地址**: `POST /api/auth/mobile/send-code`

- **接口说明**: 发送手机验证码

- **请求参数**:
  
  | 参数名    | 类型     | 必填  | 说明                         |
  | ------ | ------ | --- | -------------------------- |
  | mobile | string | 是   | 11位手机号                     |
  | type   | string | 是   | 验证码类型：LOGIN/REGISTER/RESET |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "验证码已发送",
    "data": {
      "expires_in": 300
    }
  }
  ```

### 1.4 刷新Token

- **接口地址**: `POST /api/auth/refresh`

- **接口说明**: 刷新访问令牌

- **请求参数**:
  
  | 参数名           | 类型     | 必填  | 说明   |
  | ------------- | ------ | --- | ---- |
  | refresh_token | string | 是   | 刷新令牌 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "刷新成功",
    "data": {
      "access_token": "新的access_token",
      "expires_in": 7200
    }
  }
  ```

### 1.5 退出登录

- **接口地址**: `POST /api/auth/logout`

- **接口说明**: 退出登录，清除token

- 请求头
  :
  
  ```
  Authorization: Bearer {access_token}
  ```

- 响应数据
  :
  
  ```json
  {  "code": 200,  "message": "退出成功"}
  ```

## √二、用户管理模块

### √2.1 获取用户信息

- **接口地址**: `GET /api/users/{user_id}`

- **接口说明**: 获取指定用户的公开信息

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | user_id | bigint | 是   | 用户ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "id": 1001,
      "nickname": "用户昵称",
      "avatar_url": "https://oss.example.com/avatar.jpg",
      "birthday": "1990-01-01",
      "mobile": "1111111111";            #### 加上
      "gender": 1,
      "campus_id": 1,
      "campus_name": "北京大学",
      "is_real_name": 1,
      "privacy_mobile": 1,
      "privacy_birthday": 0,
      "privacy_fans": 1,
      "created_at": "2023-01-01T00:00:00Z",
      "stats": {
        "post_count": 100,
        "follower_count": 500,
        "following_count": 200
      }
    }
  }
  ```

### √2.2 获取当前用户信息

- **接口地址**: `GET /api/users/me`

- **接口说明**: 获取当前登录用户的详细信息

- 请求头
  :
  
  ```
  Authorization: Bearer {access_token}
  ```

- 响应数据
  :
  
  ```json
  {  "code": 200,  "message": "success",  "data": {    "id": 1001,    "nickname": "用户昵称",    "avatar_url": "https://oss.example.com/avatar.jpg",    "birthday": "1990-01-01",    "gender": 1,    "campus_id": 1,    "campus_name": "北京大学",    "qq_openid": "xxx",    "mobile": "13800138000",    "real_name": "张三",    "id_card_no": "110101199001011234",    "is_real_name": 1,    "privacy_mobile": 1,    "privacy_birthday": 0,    "privacy_fans": 1,    "status": 0,    "created_at": "2023-01-01T00:00:00Z",    "updated_at": "2023-01-01T00:00:00Z"  }}
  ```

### √2.3 更新用户信息

- **接口地址**: `PUT /api/users/profile`

- **接口说明**: 更新当前用户的个人信息

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  Content-Type: application/json
  ```

- **请求参数**:
  
  | 参数名              | 类型     | 必填  | 说明                   |
  | ---------------- | ------ | --- | -------------------- |
  | nickname         | string | 否   | 昵称(最多30字符)           |
  | avatar_url       | string | 否   | 头像URL                |
  | birthday         | date   | 否   | 生日(YYYY-MM-DD)       |
  | gender           | int    | 否   | 性别：0未知 1男 2女         |
  | campus_id        | bigint | 否   | 校区ID                 |
  | privacy_mobile   | int    | 否   | 手机号可见范围：0公开 1好友 2仅自己 |
  | privacy_birthday | int    | 否   | 生日可见范围               |
  | privacy_fans     | int    | 否   | 粉丝列表可见范围             |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "更新成功",
    "data": {
      "updated_fields": ["nickname", "gender"]            ###   不返回
    }
  }
  ```

### √2.4 实名认证

- **接口地址**: `POST /api/users/real-name-auth`

- **接口说明**: 提交实名认证信息

- **请求参数**:
  
  | 参数名        | 类型     | 必填  | 说明      |
  | ---------- | ------ | --- | ------- |
  | real_name  | string | 是   | 真实姓名    |
  | id_card_no | string | 是   | 18位身份证号 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "实名认证成功",
    "data": {
      "is_real_name": 1
    }
  }
  ```

### √2.5 绑定手机号

- **接口地址**: `POST /api/users/bind-mobile`

- **接口说明**: 绑定或更换手机号

- **请求参数**:
  
  | 参数名    | 类型     | 必填  | 说明     |
  | ------ | ------ | --- | ------ |
  | mobile | string | 是   | 11位手机号 |
  | code   | string | 是   | 6位验证码  |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "绑定成功"
  }
  ```

## √三、黑名单管理

### √3.1 添加黑名单

- **接口地址**: `POST /api/users/blacklist`

- **接口说明**: 将用户加入黑名单

- **请求参数**:
  
  | 参数名       | 类型     | 必填  | 说明      |
  | --------- | ------ | --- | ------- |
  | target_id | bigint | 是   | 被拉黑用户ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "拉黑成功"
  }
  ```

### √3.2 移除黑名单

- **接口地址**: `DELETE /api/users/blacklist/{target_id}`

- **接口说明**: 将用户从黑名单移除

- **路径参数**:
  
  | 参数名       | 类型     | 必填  | 说明      |
  | --------- | ------ | --- | ------- |
  | target_id | bigint | 是   | 被拉黑用户ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "取消拉黑成功"
  }
  ```

### √3.3 黑名单列表

- **接口地址**: `GET /api/users/blacklist`

- **接口说明**: 获取黑名单列表

- **查询参数**:
  
  | 参数名  | 类型  | 必填  | 说明        |
  | ---- | --- | --- | --------- |
  | page | int | 否   | 页码，默认1    |
  | size | int | 否   | 每页数量，默认20 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 1,
          "target_id": 1002,
          "target_user": {
            "id": 1002,
            "nickname": "用户B",
            "avatar_url": "https://oss.example.com/avatar.jpg"
          },
          "created_at": "2023-01-01T00:00:00Z"
        }
      ],
      "pagination": {
        "page": 1,
        "size": 20,
        "total": 10,
        "pages": 1
      }
    }
  }
  ```

## √四、好友系统

### √4.1 发送好友请求

- **接口地址**: `POST /api/friends/request`

- **接口说明**: 向用户发送好友请求

- **请求参数**:
  
  | 参数名       | 类型     | 必填  | 说明     |
  | --------- | ------ | --- | ------ |
  | friend_id | bigint | 是   | 目标用户ID |
  | message   | string | 否   | 验证消息   |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "好友请求已发送"
  }
  ```

### √4.2 接受好友请求

- **接口地址**: `PUT /api/friends/{friend_id}/accept`

- **接口说明**: 接受好友请求

- **路径参数**:
  
  | 参数名       | 类型     | 必填  | 说明      |
  | --------- | ------ | --- | ------- |
  | friend_id | bigint | 是   | 请求方用户ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "已成为好友"
  }
  ```

### √4.3 拒绝好友请求

- **接口地址**: `PUT /api/friends/{friend_id}/refuse`

- **接口说明**: 拒绝好友请求

- **路径参数**:
  
  | 参数名       | 类型     | 必填  | 说明      |
  | --------- | ------ | --- | ------- |
  | friend_id | bigint | 是   | 请求方用户ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "已拒绝好友请求"
  }
  ```

### √4.4 删除好友

- **接口地址**: `DELETE /api/friends/{friend_id}`

- **接口说明**: 删除好友关系

- **路径参数**:
  
  | 参数名       | 类型     | 必填  | 说明     |
  | --------- | ------ | --- | ------ |
  | friend_id | bigint | 是   | 好友用户ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "删除好友成功"
  }
  ```

### √4.5 好友列表

- **接口地址**: `GET /api/friends`

- **接口说明**: 获取好友列表

- **查询参数**:
  
  | 参数名    | 类型     | 必填  | 说明                  |
  | ------ | ------ | --- | ------------------- |
  | page   | int    | 否   | 页码，默认1              |
  | size   | int    | 否   | 每页数量，默认20           |
  | status | string | 否   | 状态：PENDING/ACCEPTED |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 1,
          "friend_id": 1002,
          "friend": {
            "id": 1002,
            "nickname": "好友昵称",
            "avatar_url": "https://oss.example.com/avatar.jpg",
            "campus_name": "北京大学"
          },
          "status": "ACCEPTED",
          "created_at": "2023-01-01T00:00:00Z",
          "is_receiver": 0
        }
      ],
      "pagination": {
        "page": 1,
        "size": 20,
        "total": 50,
        "pages": 3
      }
    }
  }
  ```

### √4.6 发送私信

- **接口地址**: `POST /api/friends/messages`

- **接口说明**: 向好友发送私信

- **请求参数**:
  
  | 参数名     | 类型     | 必填  | 说明    |
  | ------- | ------ | --- | ----- |
  | to_id   | bigint | 是   | 接收者ID |
  | content | string | 是   | 消息内容  |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "发送成功",
    "data": {
      "id": 1001,
      "from_id": 1001,
      "to_id": 1002,
      "content": "消息内容",
      "created_at": "2023-01-01T00:00:00Z"
    }
  }
  ```

### √4.7 获取聊天记录

- **接口地址**: `GET /api/friends/messages`

- **接口说明**: 获取与好友的聊天记录

- **查询参数**:
  
  | 参数名       | 类型     | 必填  | 说明        |
  | --------- | ------ | --- | --------- |
  | friend_id | bigint | 是   | 好友ID      |
  | page      | int    | 否   | 页码，默认1    |
  | size      | int    | 否   | 每页数量，默认20 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 1001,
          "from_id": 1001,
          "to_id": 1002,
          "content": "消息内容",
          "created_at": "2023-01-01T00:00:00Z"
        }
      ],
      "pagination": {
        "page": 1,
        "size": 20,
        "total": 100,
        "pages": 5
      }
    }
  }
  ```

## √×五、朋友圈动态

### ×5.1 发布动态

- **接口地址**: `POST /api/posts`

- **接口说明**: 发布新动态

- **请求参数**:
  
  | 参数名         | 类型      | 必填  | 说明                        |
  | ----------- | ------- | --- | ------------------------- |
  | content     | string  | 是   | 动态内容                      |
  | visibility  | string  | 否   | 可见范围：PUBLIC/FRIEND/CAMPUS |
  | poi_lat     | decimal | 否   | 纬度                        |
  | poi_lng     | decimal | 否   | 经度                        |
  | poi_name    | string  | 否   | 位置名称                      |
  | file_ids    | array   | 否   | 文件ID数组                    |
  | topic_names | array   | 否   | 话题名称数组                    |
  | tag_ids     | array   | 否   | 标签ID数组                    |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "发布成功",
    "data": {
      "id": 2001,
      "content": "动态内容",
      "visibility": "PUBLIC",
      "status": "PUBLISHED",
      "created_at": "2023-01-01T00:00:00Z"
    }
  }
  ```

### 5.2 获取动态列表（拆分成  用户、公共 两个接口）

- **接口地址**: `GET /api/posts`

- **接口说明**: 获取动态列表

- **查询参数**:
  
  | 参数名     | 类型     | 必填  | 说明                          |
  | ------- | ------ | --- | --------------------------- |
  | type    | string | 否   | 类型：timeline/user/campus/hot |
  | user_id | bigint | 否   | 用户ID(type=user时必填)          |
  | page    | int    | 否   | 页码，默认1                      |
  | size    | int    | 否   | 每页数量，默认20                   |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 2001,
          "user": {
            "id": 1001,
            "nickname": "用户昵称",
            "avatar_url": "https://oss.example.com/avatar.jpg"
          },
          "content": "动态内容",
          "visibility": "PUBLIC",
          "poi_name": "天安门广场",
          "is_top": 0,
          "status": "PUBLISHED",
          "files": [
            {
              "id": 1001,
              "file_url": "https://oss.example.com/posts/1001.jpg",
              "thumb_url": "https://cdn.example.com/posts/1001_thumb.jpg",
              "size": 1024000
            }
          ],
          "topics": [
            {
              "id": 1,
              "name": "#北京旅游#"
            }
          ],
          "tags": [
            {
              "id": 1,
              "name": "旅游"
            }
          ],
          "stats": {
            "view_cnt": 100,
            "like_cnt": 10,
            "comment_cnt": 5,
            "share_cnt": 2
          },
          "user_actions": {
            "is_liked": false,
            "is_favorited": false
          },
          "created_at": "2023-01-01T00:00:00Z",
          "updated_at": "2023-01-01T00:00:00Z"
        }
      ],
      "pagination": {
        "page": 1,
        "size": 20,
        "total": 100,
        "pages": 5
      }
    }
  }
  ```

### 5.3 获取动态详情

- **接口地址**: `GET /api/posts/{post_id}`

- **接口说明**: 获取动态详细信息

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **响应数据**: 同动态列表中的单个动态对象

### 5.4 更新动态

- **接口地址**: `PUT /api/posts/{post_id}`

- **接口说明**: 更新自己的动态

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **请求参数**:
  
  | 参数名        | 类型     | 必填  | 说明         |
  | ---------- | ------ | --- | ---------- |
  | content    | string | 否   | 动态内容       |
  | visibility | string | 否   | 可见范围       |
  | is_top     | int    | 否   | 是否置顶：0否 1是 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "更新成功"
  }
  ```

### 5.5 删除动态

- **接口地址**: `DELETE /api/posts/{post_id}`

- **接口说明**: 删除自己的动态

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "删除成功"
  }
  ```

### 5.6 点赞动态

- **接口地址**: `POST /api/posts/{post_id}/like`

- **接口说明**: 点赞动态

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "点赞成功",
    "data": {
      "like_cnt": 11
    }
  }
  ```

### 5.7 取消点赞

- **接口地址**: `DELETE /api/posts/{post_id}/like`

- **接口说明**: 取消点赞

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "取消点赞成功",
    "data": {
      "like_cnt": 10
    }
  }
  ```

### 5.8 收藏动态

- **接口地址**: `POST /api/posts/{post_id}/favorite`

- **接口说明**: 收藏动态

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "收藏成功"
  }
  ```

### 5.9 取消收藏

- **接口地址**: `DELETE /api/posts/{post_id}/favorite`

- **接口说明**: 取消收藏

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "取消收藏成功"
  }
  ```

### 5.10 转发动态

- **接口地址**: `POST /api/posts/{post_id}/share`

- **接口说明**: 转发动态

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **请求参数**:
  
  | 参数名    | 类型     | 必填  | 说明   |
  | ------ | ------ | --- | ---- |
  | reason | string | 否   | 转发理由 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "转发成功",
    "data": {
      "share_id": 1001,
      "share_cnt": 3
    }
  }
  ```

### 5.11 发表评论

- **接口地址**: `POST /api/comments/{post_id}`

- **接口说明**: 对动态发表评论

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **请求参数**:
  
  | 参数名       | 类型     | 必填  | 说明           |
  | --------- | ------ | --- | ------------ |
  | content   | string | 是   | 评论内容         |
  | parent_id | bigint | 否   | 父评论ID，0为一级评论 |
  | at_users  | array  | 否   | @的用户ID数组     |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "评论成功",
    "data": {
      "id": 3001,
      "user": {
        "id": 1001,
        "nickname": "评论者",
        "avatar_url": "https://oss.example.com/avatar.jpg"
      },
      "content": "评论内容",
      "parent_id": 0,
      "at_users": [
        {
          "id": 1002,
          "nickname": "被@的用户"
        }
      ],
      "status": "VISIBLE",
      "created_at": "2023-01-01T00:00:00Z"
    }
  }
  ```

### 5.12 获取评论列表

- **接口地址**: `GET /api/comments/{post_id}`

- **接口说明**: 获取动态的评论列表

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **查询参数**:
  
  | 参数名  | 类型     | 必填  | 说明            |
  | ---- | ------ | --- | ------------- |
  | page | int    | 否   | 页码，默认1        |
  | size | int    | 否   | 每页数量，默认20     |
  | sort | string | 否   | 排序：hot/latest |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 3001,
          "user": {
            "id": 1001,
            "nickname": "评论者",
            "avatar_url": "https://oss.example.com/avatar.jpg"
          },
          "content": "一级评论内容",
          "parent_id": 0,
          "at_users": [],
          "like_cnt": 5, // 评论点赞数
          "is_liked": true, // 当前用户是否点赞
          "reply_count": 2, // 回复数量
          "created_at": "2023-01-01T00:00:00Z",
          "replies": [ // 二级评论（最多返回几条，或只返回 count）
            {
              "id": 3002,
              "user": {
                "id": 1002,
                "nickname": "回复者",
                "avatar_url": "https://oss.example.com/avatar_b.jpg"
              },
              "content": "回复内容",
              "parent_id": 3001,
              "at_users": [
                {
                  "id": 1001,
                  "nickname": "评论者"
                }
              ],
              "like_cnt": 2,
              "is_liked": false,
              "created_at": "2023-01-01T00:00:10Z"
            }
          ]
        }
      ],
      "pagination": {
        "page": 1,
        "size": 20,
        "total": 100,
        "pages": 5
      }
    }
  }
  ```

### 5.13 删除评论

- **接口地址**: `DELETE /api/comments/{comment_id}`

- **接口说明**: 删除自己的评论

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名        | 类型     | 必填  | 说明   |
  | ---------- | ------ | --- | ---- |
  | comment_id | bigint | 是   | 评论ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "删除评论成功"
  }
  ```

### 5.14 点赞评论

- **接口地址**: `POST /api/comments/{comment_id}/like`

- **接口说明**: 点赞评论

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名        | 类型     | 必填  | 说明   |
  | ---------- | ------ | --- | ---- |
  | comment_id | bigint | 是   | 评论ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "点赞成功",
    "data": {
      "like_cnt": 6
    }
  }
  ```

### 5.15 取消点赞评论

- **接口地址**: `DELETE /api/comments/{comment_id}/like`

- **接口说明**: 取消点赞评论

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名        | 类型     | 必填  | 说明   |
  | ---------- | ------ | --- | ---- |
  | comment_id | bigint | 是   | 评论ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "取消点赞成功",
    "data": {
      "like_cnt": 5
    }
  }
  ```

## 六、任务系统

### √6.1 发布任务

- **接口地址**: `POST /api/tasks`

- **接口说明**: 发布新任务

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  Content-Type: application/json
  ```

- **请求参数**:
  
  | 参数名        | 类型       | 必填  | 说明                                           |
  | ---------- | -------- | --- | -------------------------------------------- |
  | title      | string   | 是   | 任务标题 (最多100字符)                               |
  | content    | string   | 是   | 任务详情                                         |
  | reward     | decimal  | 是   | 悬赏金额                                         |
  | visibility | string   | 否   | 可见范围：PUBLIC/FRIEND/CAMPUS，默认PUBLIC           |
  | expire_at  | datetime | 否   | 截止报名时间 (ISO 8601格式，如 "2023-12-31T23:59:59Z") |
  | file_ids   | array    | 否   | 文件ID数组                                       |
  | tag_ids    | array    | 否   | 标签ID数组                                       |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "任务发布成功",
    "data": {
      "id": 4001,
      "publisher_id": 1001,
      "title": "帮我取快递",
      "reward": 10.50,
      "status": "AUDITING", // 发布后通常进入审核状态
      "created_at": "2023-01-01T00:00:00Z"
    }
  }
  ```

### √6.2 获取任务列表（拆分：我发布的、我接受的、公共的）

- **接口地址**: `GET /api/tasks`

- **接口说明**: 获取任务列表

- **请求头**:
  
  ```
  Authorization: Bearer {access_token} (可选，如果未登录则获取公开任务)
  ```

- **查询参数**:
  
  | 参数名     | 类型     | 必填  | 说明                                                                   |
  | ------- | ------ | --- | -------------------------------------------------------------------- |
  | type    | string | 否   | 列表类型：all/my_published/my_received/campus/hot，默认all                   |
  | status  | string | 否   | 任务状态：DRAFT/AUDITING/RECRUIT/RUNNING/DELIVER/FINISH/CLOSED/ARBITRATED |
  | tag_id  | int    | 否   | 按标签ID筛选                                                              |
  | keyword | string | 否   | 关键词搜索 (标题或内容)                                                        |
  | page    | int    | 否   | 页码，默认1                                                               |
  | size    | int    | 否   | 每页数量，默认20                                                            |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 4001,
          "publisher": {
            "id": 1001,
            "nickname": "发布者昵称",
            "avatar_url": "https://oss.example.com/avatar.jpg"
          },
          "title": "帮我取快递",
          "content": "在东门快递站取一个大包裹，送到西区宿舍楼",
          "reward": 10.50,
          "status": "RECRUIT",
          "visibility": "PUBLIC",
          "expire_at": "2023-12-31T23:59:59Z",
          "created_at": "2023-01-01T00:00:00Z",
          "files": [
            {
              "id": 1001,
              "thumb_url": "https://cdn.example.com/task/1001_thumb.jpg"
            }
          ],
          "tags": [
            {
              "id": 5,
              "name": "跑腿"
            }
          ],
          "stats": {
            "view_cnt": 200,
            "order_cnt": 3
          },
          "user_actions": {
            "is_favorited": false
          }
        }
      ],
      "pagination": {
        "page": 1,
        "size": 20,
        "total": 50,
        "pages": 3
      }
    }
  }
  ```

### √6.2 获取全部任务列表

- **接口地址**: `GET /api/tasks`

- **接口说明**: 获取全部公开任务列表

- **请求头**: `Authorization: Bearer {access_token} (可选)`

- **查询参数**:
  
  | 参数名     | 类型     | 必填  | 说明                                                                   |
  | ------- | ------ | --- | -------------------------------------------------------------------- |
  | status  | string | 否   | 任务状态：DRAFT/AUDITING/RECRUIT/RUNNING/DELIVER/FINISH/CLOSED/ARBITRATED |
  | tag_id  | int    | 否   | 按标签ID筛选                                                              |
  | keyword | string | 否   | 关键词搜索 (标题或内容)                                                        |
  | page    | int    | 否   | 页码，默认1                                                               |
  | size    | int    | 否   | 每页数量，默认20                                                            |

- **响应数据**: (保持原有响应格式不变)

### √6.3 获取我发布的任务列表

- **接口地址**: `GET /api/tasks/my-published`
- **接口说明**: 获取当前用户发布的任务列表
- **请求头**: `Authorization: Bearer {access_token} (必填)`
- **查询参数**: (同6.2，去除type参数)
- **响应数据**: (同6.2接口响应格式)

### √6.4 获取我接受的任务列表

- **接口地址**: `GET /api/tasks/my-received`
- **接口说明**: 获取当前用户接受的任务列表
- **请求头**: `Authorization: Bearer {access_token} (必填)`
- **查询参数**: (同6.2，但status只包含：RECRUIT/RUNNING/DELIVER/FINISH/CLOSED/ARBITRATED)
- **响应数据**: (同6.2接口响应格式)
  
  

### √6.3 获取任务详情

- **接口地址**: `GET /api/tasks/{task_id}`

- **接口说明**: 获取任务详细信息

- **请求头**:
  
  ```
  Authorization: Bearer {access_token} (可选)
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | task_id | bigint | 是   | 任务ID |

- **响应数据**: (同任务列表中的单个任务对象，补充content和完整file_url)
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "id": 4001,
      "publisher": {
        "id": 1001,
        "nickname": "发布者昵称",
        "avatar_url": "https://oss.example.com/avatar.jpg"
      },
      "title": "帮我取快递",
      "content": "在东门快递站取一个大包裹，送到西区宿舍楼。要求：速度快，人品好。",
      "reward": 10.50,
      "status": "RECRUIT",
      "visibility": "PUBLIC",
      "expire_at": "2023-12-31T23:59:59Z",
      "created_at": "2023-01-01T00:00:00Z",
      "files": [
        {
          "id": 1001,
          "file_url": "https://oss.example.com/task/1001.jpg",
          "thumb_url": "https://cdn.example.com/task/1001_thumb.jpg",
          "size": 500000
        }
      ],
      "tags": [
        {
          "id": 5,
          "name": "跑腿"
        }
      ],
      "stats": {
        "view_cnt": 200,
        "order_cnt": 3
      },
      "user_actions": {
        "is_favorited": false // 当前用户是否收藏
      }
    }
  }
  ```

### √6.4 更新任务

- **接口地址**: `PUT /api/tasks/{task_id}`

- **接口说明**: 更新自己的任务信息（草稿或审核中状态可修改）

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  Content-Type: application/json
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | task_id | bigint | 是   | 任务ID |

- **请求参数**:
  
  | 参数名        | 类型       | 必填  | 说明               |
  | ---------- | -------- | --- | ---------------- |
  | title      | string   | 否   | 任务标题             |
  | content    | string   | 否   | 任务详情             |
  | reward     | decimal  | 否   | 悬赏金额             |
  | visibility | string   | 否   | 可见范围             |
  | expire_at  | datetime | 否   | 截止报名时间           |
  | file_ids   | array    | 否   | 文件ID数组 (会覆盖原有文件) |
  | tag_ids    | array    | 否   | 标签ID数组 (会覆盖原有标签) |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "任务更新成功",
    "data": {
      "updated_at": "2023-01-01T00:05:00Z"
    }
  }
  ```

### √6.5 删除任务

- **接口地址**: `DELETE /api/tasks/{task_id}`

- **接口说明**: 删除自己的任务 (仅草稿或已关闭状态可删除)

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | task_id | bigint | 是   | 任务ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "任务删除成功"
  }
  ```

### √6.6 收藏任务

- **接口地址**: `POST /api/tasks/{task_id}/favorite`

- **接口说明**: 收藏任务

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | task_id | bigint | 是   | 任务ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "收藏成功"
  }
  ```

### √6.7 取消收藏任务

- **接口地址**: `DELETE /api/tasks/{task_id}/favorite`

- **接口说明**: 取消收藏任务

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | task_id | bigint | 是   | 任务ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "取消收藏成功"
  }
  ```

### 6.8 转发任务

- **接口地址**: `POST /api/tasks/{task_id}/share`

- **接口说明**: 转发任务

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  Content-Type: application/json
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | task_id | bigint | 是   | 任务ID |

- **请求参数**:
  
  | 参数名    | 类型     | 必填  | 说明   |
  | ------ | ------ | --- | ---- |
  | reason | string | 否   | 转发附言 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "转发成功",
    "data": {
      "share_id": 1002 // 转发记录ID
    }
  }
  ```

## √七、任务订单

### √7.1 接取任务 (创建订单)

- **接口地址**: `POST /api/task_orders/{task_id}`

- **接口说明**: 用户接取任务，创建任务订单

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | task_id | bigint | 是   | 任务ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "接单请求已发送",
    "data": {
      "order_id": 5001,
      "status": "WAIT_ACCEPT"
    }
  }
  ```

### √7.2 接受任务订单 (发布者操作)

- **接口地址**: `PUT /api/task_orders/{order_id}/accept`

- **接口说明**: 任务发布者接受某个接单请求

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名      | 类型     | 必填  | 说明     |
  | -------- | ------ | --- | ------ |
  | order_id | bigint | 是   | 任务订单ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "已接受接单请求",
    "data": {
      "order_id": 5001,
      "status": "ACCEPTED" // 任务状态可能变为RUNNING
    }
  }
  ```

### √7.3 拒绝任务订单 (发布者操作)

- **接口地址**: `PUT /api/task_orders/{order_id}/refuse`

- **接口说明**: 任务发布者拒绝某个接单请求

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名      | 类型     | 必填  | 说明     |
  | -------- | ------ | --- | ------ |
  | order_id | bigint | 是   | 任务订单ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "已拒绝接单请求",
    "data": {
      "order_id": 5001,
      "status": "REFUSED"
    }
  }
  ```

### √7.4 取消任务订单 (接单者操作)

- **接口地址**: `PUT /api/task_orders/{order_id}/cancel`

- **接口说明**: 接单者取消已接受的任务订单 (可能需要考虑时间限制或发布者同意)

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名      | 类型     | 必填  | 说明     |
  | -------- | ------ | --- | ------ |
  | order_id | bigint | 是   | 任务订单ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "任务订单已取消",
    "data": {
      "order_id": 5001,
      "status": "CANCELLED"
    }
  }
  ```

### √7.5 完成任务订单 (接单者操作)

- **接口地址**: `PUT /api/task_orders/{order_id}/finish`

- **接口说明**: 接单者标记任务已完成

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名      | 类型     | 必填  | 说明     |
  | -------- | ------ | --- | ------ |
  | order_id | bigint | 是   | 任务订单ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "任务已标记完成，等待发布者确认",
    "data": {
      "order_id": 5001,
      "status": "DELIVER" // 任务状态可能变为DELIVER
    }
  }
  ```

### √7.6 确认任务完成 (发布者操作)

- **接口地址**: `PUT /api/task_orders/{order_id}/confirm-finish`

- **接口说明**: 任务发布者确认任务已完成

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名      | 类型     | 必填  | 说明     |
  | -------- | ------ | --- | ------ |
  | order_id | bigint | 是   | 任务订单ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "任务已确认完成",
    "data": {
      "order_id": 5001,
      "status": "FINISH" // 任务状态变为FINISH
    }
  }
  ```

### √7.7 获取我的任务订单列表

- **接口地址**: `GET /api/task_orders`

- **接口说明**: 获取当前用户相关的任务订单列表 (作为发布者或接单者)

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **查询参数**:
  
  | 参数名       | 类型     | 必填  | 说明                                                 |
  | --------- | ------ | --- | -------------------------------------------------- |
  | role_type | string | 否   | 角色类型：PUBLISHER/RECEIVER，默认ALL                      |
  | status    | string | 否   | 订单状态：WAIT_ACCEPT/ACCEPTED/REFUSED/CANCELLED/FINISH |
  | page      | int    | 否   | 页码，默认1                                             |
  | size      | int    | 否   | 每页数量，默认20                                          |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 5001,
          "task_id": 4001,
          "task_title": "帮我取快递",
          "publisher": {
            "id": 1001,
            "nickname": "任务发布者",
            "avatar_url": "..."
          },
          "receiver": {
            "id": 1002,
            "nickname": "任务接单者",
            "avatar_url": "..."
          },
          "status": "ACCEPTED",
          "created_at": "2023-01-01T00:00:00Z",
          "updated_at": "2023-01-01T00:05:00Z"
        }
      ],
      "pagination": {
        "page": 1,
        "size": 20,
        "total": 10,
        "pages": 1
      }
    }
  }
  ```

## 八、任务评价

### 8.1 提交任务评价

- **接口地址**: `POST /api/task_orders/reviews`

- **接口说明**: 对已完成的任务进行评价 (发布者评价接单者，接单者评价发布者)

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  Content-Type: application/json
  ```

- **请求参数**:
  
  | 参数名         | 类型     | 必填  | 说明                        |
  | ----------- | ------ | --- | ------------------------- |
  | task_id     | bigint | 是   | 任务ID                      |
  | order_id    | bigint | 是   | 关联订单ID                    |
  | reviewee_id | bigint | 是   | 被评价者UID                   |
  | role_type   | string | 是   | 评价方角色：PUBLISHER/RECEIVER  |
  | score       | int    | 是   | 评分：1~5星                   |
  | tags        | array  | 否   | 评价标签JSON数组，如 ["准时", "负责"] |
  | content     | string | 否   | 文字评价 (最多500字符)            |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "评价成功",
    "data": {
      "review_id": 6001,
      "created_at": "2023-01-01T00:00:00Z"
    }
  }
  ```

### 8.2 获取任务评价列表

- **接口地址**: `GET /api/task_orders/{task_id}/tasks/reviews`

- **接口说明**: 获取指定任务的评价列表

- **请求头**:
  
  ```
  Authorization: Bearer {access_token} (可选)
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | task_id | bigint | 是   | 任务ID |

- **查询参数**:
  
  | 参数名       | 类型     | 必填  | 说明                             |
  | --------- | ------ | --- | ------------------------------ |
  | role_type | string | 否   | 评价方角色：PUBLISHER/RECEIVER，默认ALL |
  | page      | int    | 否   | 页码，默认1                         |
  | size      | int    | 否   | 每页数量，默认20                      |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 6001,
          "task_id": 4001,
          "reviewer": {
            "id": 1001,
            "nickname": "评价者",
            "avatar_url": "..."
          },
          "reviewee": {
            "id": 1002,
            "nickname": "被评价者",
            "avatar_url": "..."
          },
          "role_type": "PUBLISHER",
          "score": 5,
          "tags": ["准时", "高效"],
          "content": "非常满意，按时完成。",
          "created_at": "2023-01-01T00:00:00Z"
        }
      ],
      "pagination": {
        "page": 1,
        "size": 20,
        "total": 2,
        "pages": 1
      }
    }
  }
  ```

### 8.3 获取用户收到的评价

- **接口地址**: `GET /api/task_orders/{user_id}/users/reviews`

- **接口说明**: 获取某个用户收到的所有任务评价

- **请求头**:
  
  ```
  Authorization: Bearer {access_token} (可选)
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | user_id | bigint | 是   | 用户ID |

- **查询参数**:
  
  | 参数名  | 类型  | 必填  | 说明        |
  | ---- | --- | --- | --------- |
  | page | int | 否   | 页码，默认1    |
  | size | int | 否   | 每页数量，默认20 |

- **响应数据**: 同 8.2 获取任务评价列表

## √九、文件上传

### 9.1 上传文件

- **接口地址**: `POST /api/files/upload`

- **接口说明**: 上传文件至OSS，并记录文件信息

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  Content-Type: multipart/form-data
  ```

- **请求参数**:
  
  | 参数名      | 类型     | 必填  | 说明                               |
  | -------- | ------ | --- | -------------------------------- |
  | file     | file   | 是   | 要上传的文件                           |
  | biz_type | string | 是   | 业务类型：AVATAR/BG/POST/TASK/COMMENT |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "上传成功",
    "data": {
      "id": 1001,
      "user_id": 1001,
      "biz_type": "POST",
      "file_url": "https://oss.example.com/posts/xyz.jpg",
      "thumb_url": "https://cdn.example.com/posts/xyz_thumb.jpg",
      "size": 1024000,
      "created_at": "2023-01-01T00:00:00Z"
    }
  }
  ```

## 十、通知中心

### 10.1 获取通知列表（针对用户的通知）

- **接口地址**: `GET /api/notifications`

- **接口说明**: 获取当前登录用户的通知列表

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **查询参数**:
  
  | 参数名    | 类型     | 必填  | 说明                                                           |
  | ------ | ------ | --- | ------------------------------------------------------------ |
  | type   | string | 否   | 通知类型：LIKE/FAVORITE/COMMENT/SHARE/TASK_ORDER/SYSTEM/VIOLATION |
  | status | string | 否   | 阅读状态：UNREAD/READ，默认UNREAD                                    |
  | page   | int    | 否   | 页码，默认1                                                       |
  | size   | int    | 否   | 每页数量，默认20                                                    |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 7001,
          "type": "LIKE",
          "title": "您的动态收到了新的赞",
          "content": "用户昵称 赞了您的动态 “今天天气真好”",
          "ref_id": 2001,
          "ref_type": "POST",
          "status": "UNREAD",
          "created_at": "2023-01-01T00:00:00Z",
          "from_user": { // 如果是用户互动类通知，可包含来源用户信息
            "id": 1002,
            "nickname": "用户昵称",
            "avatar_url": "..."
          },
          "count": 1,
        }
      ],
      "pagination": {
        "page": 1,
        "size": 20,
        "total": 5,
        "pages": 1
      }
    }
  }
  ```

### 10.2 标记通知为已读

- **接口地址**: `PUT /api/notifications/{notification_id}/read`

- **接口说明**: 标记单条通知为已读

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **路径参数**:
  
  | 参数名             | 类型     | 必填  | 说明   |
  | --------------- | ------ | --- | ---- |
  | notification_id | bigint | 是   | 通知ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "通知已标记为已读"
  }
  ```

### ~~10.3 标记所有通知为已读~~

- **接口地址**: `PUT /api/notifications/read_all`

- **接口说明**: 标记所有未读通知为已读

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "所有通知已标记为已读"
  }
  ```

### 10.4 获取未读通知数量(总的通知数)

- **接口地址**: `GET /api/notifications/unread_count`

- **接口说明**: 获取当前登录用户的未读通知数量

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  ```

- **响应数据**:
  
  ```js
  {
    "code": 200,
    "message": "success",
    "data":{
          "count":5
      }
  }
  ```

好的，我已经详细分析了您提供的数据库表结构，并结合第一部分接口文档的内容，继续为您完善了第二部分的接口文档。

目前已经为您补充了**朋友圈动态 (续)**、**任务系统**、**任务订单**、**任务评价**、**文件上传** 和 **通知中心** 模块的接口文档。

接下来，我将继续完善剩余的模块：**标签与话题**、**搜索**、**数据统计**、**运营管理**、**个人主页** 和 **举报投诉**。

## 十一、标签与话题

### 11.1 获取热门标签

- **接口地址**: `GET /api/tags/hot`

- **接口说明**: 获取热门标签列表

- **查询参数**:
  
  | 参数名      | 类型     | 必填  | 说明                  |
  | -------- | ------ | --- | ------------------- |
  | category | string | 否   | 业务类型：TASK/POST，默认全部 |
  | limit    | int    | 否   | 数量限制，默认10           |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 1,
          "name": "校园生活",
          "category": "POST",
          "weight": 100,
          "is_hot": 1
        },
        {
          "id": 5,
          "name": "跑腿",
          "category": "TASK",
          "weight": 90,
          "is_hot": 1
        }
      ]
    }
  }
  ```

### 11.2 获取所有标签

- **接口地址**: `GET /api/tags`

- **接口说明**: 获取所有标签列表（可按分类筛选）

- **查询参数**:
  
  | 参数名      | 类型     | 必填  | 说明                  |
  | -------- | ------ | --- | ------------------- |
  | category | string | 否   | 业务类型：TASK/POST，默认全部 |
  | page     | int    | 否   | 页码，默认1              |
  | size     | int    | 否   | 每页数量，默认20           |

- **响应数据**: 同 11.1 获取热门标签，增加分页信息

### √11.3 获取热门话题

- **接口地址**: `GET /api/topics/hot`

- **接口说明**: 获取热门话题列表

- **查询参数**:
  
  | 参数名   | 类型  | 必填  | 说明        |
  | ----- | --- | --- | --------- |
  | limit | int | 否   | 数量限制，默认10 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 1,
          "name": "#校园新鲜事#",
          "description": "分享校园里发生的新奇有趣的事情",
          "post_cnt": 1500
        },
        {
          "id": 2,
          "name": "#期末复习挑战#",
          "description": "一起挑战期末复习，互相监督打卡",
          "post_cnt": 800
        }
      ]
    }
  }
  ```

### √11.4 获取话题详情

- **接口地址**: `GET /api/topics/{topic_id}`

- **接口说明**: 获取指定话题的详细信息

- **路径参数**:
  
  | 参数名      | 类型     | 必填  | 说明   |
  | -------- | ------ | --- | ---- |
  | topic_id | bigint | 是   | 话题ID |

- **响应数据**: (同 11.3 热门话题中的单个话题对象)

### √11.5 获取话题下的动态列表

- **接口地址**: `GET /api/topics/{topic_id}/posts`

- **接口说明**: 获取指定话题下的动态列表

- **路径参数**:
  
  | 参数名      | 类型     | 必填  | 说明   |
  | -------- | ------ | --- | ---- |
  | topic_id | bigint | 是   | 话题ID |

- **查询参数**:
  
  | 参数名  | 类型     | 必填  | 说明            |
  | ---- | ------ | --- | ------------- |
  | page | int    | 否   | 页码，默认1        |
  | size | int    | 否   | 每页数量，默认20     |
  | sort | string | 否   | 排序：hot/latest |

- **响应数据**: 同 5.2 获取动态列表的响应数据结构

## 十二、搜索

### 12.1 综合搜索

- **接口地址**: `GET /api/search`

- **接口说明**: 综合搜索用户、动态、任务等内容

- **查询参数**:
  
  | 参数名     | 类型     | 必填  | 说明                            |
  | ------- | ------ | --- | ----------------------------- |
  | keyword | string | 是   | 搜索关键词                         |
  | type    | string | 否   | 搜索类型：USER/POST/TASK/ALL，默认ALL |
  | page    | int    | 否   | 页码，默认1                        |
  | size    | int    | 否   | 每页数量，默认20                     |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "users": {
        "list": [
          {
            "id": 1001,
            "nickname": "张三",
            "avatar_url": "..."
          }
        ],
        "pagination": {
          "page": 1, "size": 20, "total": 10, "pages": 1
        }
      },
      "posts": {
        "list": [
          {
            "id": 2001,
            "user": {
              "id": 1002, "nickname": "李四", "avatar_url": "..."
            },
            "content": "寻找志同道合的朋友...",
            "created_at": "2023-01-01T00:00:00Z"
          }
        ],
        "pagination": {
          "page": 1, "size": 20, "total": 20, "pages": 1
        }
      },
      "tasks": {
        "list": [
          {
            "id": 4001,
            "publisher": {
              "id": 1003, "nickname": "王五", "avatar_url": "..."
            },
            "title": "帮我带饭",
            "reward": 5.00,
            "status": "RECRUIT"
          }
        ],
        "pagination": {
          "page": 1, "size": 20, "total": 5, "pages": 1
        }
      }
    }
  }
  ```

### 12.2 获取热门    ~~搜索词~~  话题

- **接口地址**: `GET /api/search/hotwords`

- **接口说明**: 获取当前热门搜索词列表

- **查询参数**:
  
  | 参数名   | 类型  | 必填  | 说明        |
  | ----- | --- | --- | --------- |
  | limit | int | 否   | 数量限制，默认10 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {"keyword": "校园兼职", "search_cnt": 1200},
        {"keyword": "期末资料", "search_cnt": 800}
      ]
    }
  }
  ```

### 12.2 获取热门 动态( 接口补充)









## 十三、数据统计

### 13.1 获取动态统计数据

- **接口地址**: `GET /api/stats/posts/{post_id}`

- **接口说明**: 获取指定动态的浏览量、点赞数、评论数、转发数

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | post_id | bigint | 是   | 动态ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "post_id": 2001,
      "view_cnt": 150,
      "like_cnt": 25,
      "comment_cnt": 12,
      "share_cnt": 3
    }
  }
  ```

### 13.2 获取任务统计数据

- **接口地址**: `GET /api/stats/tasks/{task_id}`

- **接口说明**: 获取指定任务的浏览量、接单数

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | task_id | bigint | 是   | 任务ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "task_id": 4001,
      "view_cnt": 300,
      "order_cnt": 5
    }
  }
  ```

### 13.3 获取用户统计数据

- **接口地址**: `GET /api/stats/users/{user_id}`

- **接口说明**: 获取指定用户的动态数、关注数、粉丝数（仅公开信息）

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明   |
  | ------- | ------ | --- | ---- |
  | user_id | bigint | 是   | 用户ID |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "user_id": 1001,
      "post_count": 50,
      "follower_count": 120, // 粉丝数
      "following_count": 80  // 关注数 (如果未来新增关注功能)
    }
  }
  ```

## 十四、运营管理 (后台接口，通常需要管理员权限)

### 14.1 获取敏感词列表

- **接口地址**: `GET /api/admin/sensitive_words`

- **接口说明**: 获取敏感词列表

- **请求头**:
  
  ```
  Authorization: Bearer {admin_access_token}
  ```

- **查询参数**:
  
  | 参数名   | 类型  | 必填  | 说明        |
  | ----- | --- | --- | --------- |
  | page  | int | 否   | 页码，默认1    |
  | size  | int | 否   | 每页数量，默认20 |
  | level | int | 否   | 危险等级筛选    |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {"word": "敏感词A", "level": 3},
        {"word": "敏感词B", "level": 2}
      ],
      "pagination": {
        "page": 1, "size": 20, "total": 100, "pages": 5
      }
    }
  }
  ```

### 14.2 添加敏感词

- **接口地址**: `POST /api/admin/sensitive_words`

- **接口说明**: 添加新的敏感词

- **请求头**:
  
  ```
  Authorization: Bearer {admin_access_token}
  Content-Type: application/json
  ```

- **请求参数**:
  
  | 参数名   | 类型     | 必填  | 说明       |
  | ----- | ------ | --- | -------- |
  | word  | string | 是   | 敏感词      |
  | level | int    | 否   | 危险等级，默认1 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "敏感词添加成功"
  }
  ```

### 14.3 删除敏感词

- **接口地址**: `DELETE /api/admin/sensitive_words/{word}`

- **接口说明**: 删除指定敏感词

- **请求头**:
  
  ```
  Authorization: Bearer {admin_access_token}
  ```

- **路径参数**:
  
  | 参数名  | 类型     | 必填  | 说明  |
  | ---- | ------ | --- | --- |
  | word | string | 是   | 敏感词 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "敏感词删除成功"
  }
  ```

### 14.4 发布系统公告

- **接口地址**: `POST /api/admin/system_notices`

- **接口说明**: 发布新的系统公告

- **请求头**:
  
  ```
  Authorization: Bearer {admin_access_token}
  Content-Type: application/json
  ```

- **请求参数**:
  
  | 参数名        | 类型       | 必填  | 说明     |
  | ---------- | -------- | --- | ------ |
  | title      | string   | 是   | 公告标题   |
  | content    | string   | 是   | 公告正文   |
  | start_time | datetime | 否   | 生效开始时间 |
  | end_time   | datetime | 否   | 生效结束时间 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "公告发布成功",
    "data": {
      "notice_id": 8001
    }
  }
  ```

### 14.5 获取系统公告列表

- **接口地址**: `GET /api/system_notices`

- **接口说明**: 获取系统公告列表 (所有用户可见)

- **查询参数**:
  
  | 参数名  | 类型  | 必填  | 说明        |
  | ---- | --- | --- | --------- |
  | page | int | 否   | 页码，默认1    |
  | size | int | 否   | 每页数量，默认20 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 8001,
          "title": "系统维护通知",
          "content": "为了提供更好的服务，系统将于...",
          "start_time": "2023-01-01T00:00:00Z",
          "end_time": "2023-01-02T00:00:00Z",
          "created_at": "2023-01-01T00:00:00Z"
        }
      ],
      "pagination": {
        "page": 1, "size": 20, "total": 5, "pages": 1
      }
    }
  }
  ```

### 14.6 修改热搜词状态

- **接口地址**: `PUT /api/admin/search_hotwords/{keyword}/status`

- **接口说明**: 修改热搜词的 `is_hot` 状态

- **请求头**:
  
  ```
  Authorization: Bearer {admin_access_token}
  Content-Type: application/json
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明  |
  | ------- | ------ | --- | --- |
  | keyword | string | 是   | 关键词 |

- **请求参数**:
  
  | 参数名    | 类型  | 必填  | 说明         |
  | ------ | --- | --- | ---------- |
  | is_hot | int | 是   | 是否上榜：0否 1是 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "热搜词状态更新成功"
  }
  ```

### 14.7 添加搜索黑名单

- **接口地址**: `POST /api/admin/search_blacklist`

- **接口说明**: 将关键词加入搜索黑名单

- **请求头**:
  
  ```
  Authorization: Bearer {admin_access_token}
  Content-Type: application/json
  ```

- **请求参数**:
  
  | 参数名     | 类型     | 必填  | 说明    |
  | ------- | ------ | --- | ----- |
  | keyword | string | 是   | 屏蔽关键词 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "关键词已加入搜索黑名单"
  }
  ```

### 14.8 移除搜索黑名单

- **接口地址**: `DELETE /api/admin/search_blacklist/{keyword}`

- **接口说明**: 将关键词从搜索黑名单移除

- **请求头**:
  
  ```
  Authorization: Bearer {admin_access_token}
  ```

- **路径参数**:
  
  | 参数名     | 类型     | 必填  | 说明    |
  | ------- | ------ | --- | ----- |
  | keyword | string | 是   | 屏蔽关键词 |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "关键词已从搜索黑名单移除"
  }
  ```

## 十五、举报投诉

### 15.1 提交举报

- **接口地址**: `POST /api/reports`

- **接口说明**: 用户提交举报信息

- **请求头**:
  
  ```
  Authorization: Bearer {access_token}
  Content-Type: application/json
  ```

- **请求参数**:
  
  | 参数名       | 类型     | 必填  | 说明                           |
  | --------- | ------ | --- | ---------------------------- |
  | item_id   | bigint | 是   | 被举报对象ID                      |
  | item_type | string | 是   | 被举报类型：POST/TASK/COMMENT/USER |
  | reason    | string | 是   | 举报理由（如：色情低俗/广告骚扰/政治敏感等）      |
  | content   | string | 否   | 详细说明                         |
  | file_ids  | array  | 否   | 附件文件ID数组（如截图）                |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "举报已提交，我们将尽快处理",
    "data": {
      "report_id": 9001
    }
  }
  ```

### 15.2 获取举报列表 (后台接口)

- **接口地址**: `GET /api/admin/reports`

- **接口说明**: 后台管理员获取举报列表

- **请求头**:
  
  ```
  Authorization: Bearer {admin_access_token}
  ```

- **查询参数**:
  
  | 参数名       | 类型     | 必填  | 说明                            |
  | --------- | ------ | --- | ----------------------------- |
  | item_type | string | 否   | 被举报类型：POST/TASK/COMMENT/USER  |
  | status    | string | 否   | 处理状态：PENDING/ACCEPTED/REFUSED |
  | user_id   | bigint | 否   | 举报人ID筛选                       |
  | page      | int    | 否   | 页码，默认1                        |
  | size      | int    | 否   | 每页数量，默认20                     |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "list": [
        {
          "id": 9001,
          "user_id": 1001,
          "item_id": 2001,
          "item_type": "POST",
          "reason": "内容违规",
          "status": "PENDING",
          "created_at": "2023-01-01T00:00:00Z",
          "reported_user": { // 被举报用户/动态/任务的简要信息
            "id": 1002, "nickname": "被举报人"
          },
          "reported_item_preview": "动态内容预览..."
        }
      ],
      "pagination": {
        "page": 1, "size": 20, "total": 10, "pages": 1
      }
    }
  }
  ```

### 15.3 处理举报 (后台接口)

- **接口地址**: `PUT /api/admin/reports/{report_id}/status`

- **接口说明**: 后台管理员处理举报，更新其状态

- **请求头**:
  
  ```
  Authorization: Bearer {admin_access_token}
  Content-Type: application/json
  ```

- **路径参数**:
  
  | 参数名       | 类型     | 必填  | 说明   |
  | --------- | ------ | --- | ---- |
  | report_id | bigint | 是   | 举报ID |

- **请求参数**:
  
  | 参数名    | 类型     | 必填  | 说明                    |
  | ------ | ------ | --- | --------------------- |
  | status | string | 是   | 处理状态：ACCEPTED/REFUSED |
  | remark | string | 否   | 处理备注                  |

- **响应数据**:
  
  ```json
  {
    "code": 200,
    "message": "举报处理成功"
  }
  ```

---

至此，您提供的数据库表结构中涉及的接口文档已经全部完成补充。

**总结与建议：**

* **API文档规范性良好:** 接口地址、说明、请求头、请求参数、响应数据等都已清晰定义，易于前后端开发人员理解和对接。
* **功能覆盖全面:** 涵盖了社交平台的核心功能，并考虑到了运营和数据支撑。
* **安全机制初步建立:** 认证机制、CSRF防护等都有体现。
* **可扩展性:** `item_type` 和 `item_id` 的设计在多处使用，提高了系统的通用性和可扩展性。

**后续可以考虑的点：**

1. **错误码标准化:** 目前响应中只有 `code: 200` 和 `message: "success"`，实际项目中需要更详细的错误码和错误信息，以便前端进行国际化和精细化错误处理。
2. **详细的请求参数示例:** 对于复杂的请求参数，可以提供更具体的示例。
3. **分页功能的完善:** 明确 `total` 和 `pages` 的计算逻辑，以及在不同列表类型下的具体表现。
4. **接口权限管理:** 在文档中明确哪些接口需要用户登录，哪些需要特定角色权限（如管理员），哪些是公开接口。
5. **WebSocket集成:** 如果私信、通知需要实时性，可以补充 WebSocket 接口的文档。
6. **文件服务详细说明:** 文件上传后的 URL 规则、缩略图生成规则等可以更详细说明。
7. **第三方集成回调:** QQ/微信等授权登录通常涉及回调接口，文档中可以补充这部分内容。

希望这份完善的接口文档能够帮助到您！
